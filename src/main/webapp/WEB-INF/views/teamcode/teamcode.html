<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="icon" href="../../../resources/images/faviconWbO.png" th:href="@{resources/images/faviconWbO.png}"/>

    <title>Team Code</title>

    <link href="../../../resources/css/bootstrap.css" rel="stylesheet" media="screen"
          th:href="@{/resources/css/bootstrap.css}"/>
    <link href="../../../resources/css/core.css" rel="stylesheet" media="screen" th:href="@{/resources/css/core.css}"/>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.js"></script>

    <script src="../../../resources/js/zone/jquery.js" th:src="@{/resources/js/zone/jquery.js}"></script>
    <script src="../../../resources/js/zone/jquery.layout.js" th:src="@{/resources/js/zone/jquery.layout.js}"></script>
    <script src="../../../resources/js/zone/jquery.ui.all.js" th:src="@{/resources/js/zone/jquery.ui.all.js}"></script>
    <script src="../../../resources/js/zone.js" th:src="@{/resources/js/zone.js}"></script>

    <script src="../../../resources/js/ace-builds-master/src-min-noconflict/ace.js"
            th:href="@{/resources/js/ace-builds-master/src-min-noconflict/ace.js}"></script>
    <script src="../../../resources/js/ace-builds-master/src-min-noconflict/ext-language_tools.js"
            th:href="@{/resources/js/ace-builds-master/src-min-noconflict/ext-language_tools.js}"></script>
    <script src="../../../resources/js/editeur.js" th:src="@{/resources/js/editeur.js}"></script>
    <script src="../../../resources/js/streaming/pixi.js" th:src="@{/resources/js/streaming/pixi.js}"></script>
    <script src="../../../resources/js/streaming/importTexture.js"
            th:src="@{/resources/js/streaming/importTexture.js}"></script>


</head>
<body>

<div th:replace="fragments/header :: header">Header</div>

<div class="box">
    <div class="outer-center">


        <input type="hidden" id="idParty" value="" th:value="${party.id}"/>
        <ul class="nav nav-tabs" id="myTab">


            <li class="dropdown">
                <a data-toggle="dropdown" class="dropdown-toggle" href="#">Liste des agents <b class="caret"></b></a>
                <ul class="dropdown-menu">


                    <li class="webcode-request" th:each="agent : ${agents}" th:data="${agent.id}">
                        <input type="hidden" value="" th:value="${agent.id}"/>
                        <a data-toggle="tab" th:href="'#'+${agent.id}" th:text="${agent.type}">
                            Ag
                        </a>
                    </li>

                </ul>
            </li>
        </ul>
        <div class="tab-content">

            <div th:id="${agent.id}" th:each="agent : ${agents}" class="tab-pane fade">
                <div th:id="${agent.id}+'-editor'" class="editor"></div>
                <a href="#" class="btn btn-sm btn-warning pause"> Pause</a>
                <a href="#" class="btn btn-sm btn-danger stop"> Stop</a>
                <a href="#" class="btn btn-sm btn-primary save" th:id="${agent.id}"> Save</a>
                <a href="#" class="btn btn-sm btn-info load" th:id="${agent.id}"> Load</a>


            </div>

        </div>

    </div>

    <div class="outer-west">

        <div id="stream" class="middle-center">

            <!-- STREAM -->

        </div>

        <div id="console" class="ui-layout-south">

            <ul class="nav nav-tabs console" role="tablist">
                <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab"
                                                          data-toggle="tab">Console</a></li>
                <li role="presentation"><a href="#map" aria-controls="map" role="tab" data-toggle="tab">Map</a></li>
                <li role="presentation"><a href="#agent" aria-controls="agent" role="tab" data-toggle="tab">Agent</a>
                </li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content console">
                <div role="tabpanel" class="tab-pane active" id="home">Sortie de console générale avec les bugs</div>
                <div role="tabpanel" class="tab-pane" id="map">
                    <table class="table table-bordered">
                        <tr class="mapFood">
                            <td>Food</td>
                            <td id="numberOfFoodConsoleMap">0</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="mapNameTeam">Team</td>
                            <td class="mapRed" id="nameRedTeamConsoleMap">Null</td>
                            <td class="mapBlue" id="nameBlueTeamConsoleMap">Null</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">WarBase</td>
                            <td class="mapRed" id="numberOfBaseRed">0</td>
                            <td class="mapBlue" id="numberOfBaseBlue">0</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">WarExplorer</td>
                            <td class="mapRed" id="numberOfExplorerRed">0</td>
                            <td class="mapBlue" id="numberOfExplorerBlue">0</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">WarEngineer</td>
                            <td class="mapRed" id="numberOfEngineerRed">0</td>
                            <td class="mapBlue" id="numberOfEngineerBlue">0</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">WarRocketLauncher</td>
                            <td class="mapRed" id="numberOfRocketLauncherRed">0</td>
                            <td class="mapBlue" id="numberOfRocketLauncherBlue">0</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">WarKamikaze</td>
                            <td class="mapRed" id="numberOfKamikazeRed">0</td>
                            <td class="mapBlue" id="numberOfKamikazeBlue">0</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">WarTurret</td>
                            <td class="mapRed" id="numberOfTurretRed">0</td>
                            <td class="mapBlue" id="numberOfTurretBlue">0</td>
                        </tr>
                        <tr>
                            <td class="mapNameAgent">Wall</td>
                            <td class="mapRed" id="numberOfWallRed">0</td>
                            <td class="mapBlue" id="numberOfWallBlue">0</td>
                        </tr>
                    </table>
                </div>
                <div role="tabpanel" class="tab-pane" id="agent">
                    <table class="table table-bordered">
                        <tr class="">
                            <td class="mapNameTeam">Name</td>
                            <td class="mapAgentName" id="nameOfAgentFollow">null</td>
                        </tr>
                        <tr class="">
                            <td class="mapNameAgent">Team</td>
                            <td class="mapAgentOther" id="teamOfAgentFollow">null</td>
                        </tr>
                        <tr class="">
                            <td class="mapNameAgent">Type</td>
                            <td class="mapAgentOther" id="typeOfAgentFollow">null</td>
                        </tr>
                        <tr class="">
                            <td class="mapNameAgent">Life (%)</td>
                            <td class="mapAgentOther" id="lifeOfAgentFollow">0 %</td>
                        </tr>
                        <tr class="">
                            <td class="mapNameAgent">Debug message</td>
                            <td class="mapAgentOther" id="debugMessageOfAgentFollow">null</td>
                        </tr>
                        <tr class="">
                            <td class="mapNameAgent">Angle</td>
                            <td class="mapAgentOther" id="angleOfAgentFollow">0</td>
                        </tr>
                    </table>
                </div>
            </div>

        </div>
    </div>


</div>

<script src="../../../resources/js/sockjs.min.js" th:src="@{/resources/js/sockjs.js}"></script>
<script src="../../../resources/js/stomp.min.js" th:src="@{/resources/js/stomp.js}"></script>
<!-- application -->
<script src="../../../resources/js/webgame.js" th:src="@{/resources/js/webgame.js}"></script>
<script src="../../../resources/js/request-data-editor.js" th:src="@{/resources/js/request-data-editor.js}"></script>
<script src="../../../resources/js/streaming/testMessage.js"
        th:src="@{/resources/js/streaming/testMessage.js}"></script>
<script src="../../../resources/js/streaming/drawStreaming.js"
        th:src="@{/resources/js/streaming/drawStreaming.js}"></script>
<script src="../../../resources/js/duel.js" th:src="@{/resources/js/duel.js}"></script>

<script th:inline="javascript">
(function() {
        var path =  /*[[@{/warbot}]]*/ /warbot;
        var socket = new SockJS(path);
        var stompClient = Stomp.over(socket);

        var appModel = new WebGameModel(stompClient);
        appM = appModel;
        idP = $("#idParty")[0].value;
        //ko.applyBindings(appModel);

        appModel.connect();
        $(".btn.btn-sm.btn-success.launch").click(function (event)
        {
            /*if(!partyInGame) {
                var idParty = $("#idParty")[0].value;
                appModel.launchParty(idParty,-1);
                partyInGame = true;
                partyStart = true;
            }
            else {

            }*/
        });

        $(".webcode-request").click(function(event)
        {
          //var child = $(this).children("input");
          //var vidAgent = child[0].value;
          //var vidParty = $("#idParty")[0].value;
          //appModel.get(vidParty,vidAgent);
        });

         $(".btn.btn-sm.btn-primary.save").click(function(event)
        {
          var child = $(this);
          var vidAgent = child[0].id;
          var vidParty = $("#idParty")[0].value;
          var vCode = editors[vidAgent+"-editor"].getSession().getValue();
          appModel.save(vidParty,vidAgent, vCode);
        });

        $(".btn.btn-sm.btn-info.load").click(function(event)
        {
          var child = $(this);
          var vidAgent = child[0].id;
          var vidParty = $("#idParty")[0].value;
          appModel.get(vidParty,vidAgent);
        });

        $(".btn.btn-sm.btn-warning.debug").click(function(event)
        {
            initHUDDebug();
        });

        $(".btn.btn-sm.btn-danger.stop").click(function(event)
        {
            appModel.stop();
        });

        //appModel.pushNotification("Trade results take a 2-3 second simulated delay. Notifications will appear.");
      })();

</script>
</body>
</html>

